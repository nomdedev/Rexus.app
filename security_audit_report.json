{
  "timestamp": "2025-08-23T12:00:00Z",
  "project": "Rexus.app",
  "audit_source": "AUDITORIA_EXPERTA_2025",
  "overall_status": "FAILED",
  "summary": {
    "total_validations": 4,
    "total_issues_found": 79,
    "critical_validations_failed": 1,
    "validations_passed": 3
  },
  "validations": [
    {
      "type": "cursor_execute_validation",
      "issues_found": 79,
      "issues": [
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\core\\\\audit_trail.py', line=312, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\core\\\\backup_manager.py', line=139, content='cursor.execute(statement)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\core\\\\rbac_system.py', line=368, content='cursor.execute(\"CREATE INDEX IF NOT EXISTS idx_rbac_user_roles_usuario ON rbac_user_roles(usuario_id)\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\core\\\\rbac_system.py', line=369, content='cursor.execute(\"CREATE INDEX IF NOT EXISTS idx_rbac_role_permissions_role ON rbac_role_permissions(role_id)\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\core\\\\sql_query_manager.py', line=151, content='cursor.execute(\"BEGIN\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\models\\\\productos_model.py', line=180, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\models\\\\productos_model.py', line=581, content='cursor.execute(\"SELECT COUNT(*) FROM productos WHERE codigo = ?\", (codigo,))', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\model.py', line=417, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=156, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=160, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=255, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=396, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=421, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=553, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\contabilidad\\\\model.py', line=661, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\recursos_humanos\\\\model.py', line=195, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\recursos_humanos\\\\model.py', line=329, content='cursor.execute(empleados_query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\recursos_humanos\\\\model.py', line=753, content='cursor.execute(query_total)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\recursos_humanos\\\\model.py', line=758, content='cursor.execute(query_estado)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\administracion\\\\recursos_humanos\\\\model.py', line=763, content='cursor.execute(query_departamento)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\compras\\\\detalle_model.py', line=126, content='cursor.execute(sql_select)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\compras\\\\proveedores_model.py', line=109, content='cursor.execute(sql_select)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\compras\\\\pedidos\\\\model.py', line=244, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\herrajes\\\\model.py', line=20, content='cursor.execute(\"DELETE FROM herrajes_obra WHERE herraje_id = (SELECT id FROM herrajes WHERE codigo = ?)\", (codigo,))', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\categorias_manager.py', line=54, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\categorias_manager.py', line=82, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\categorias_manager.py', line=424, content='cursor.execute(query_vacias)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\categorias_manager.py', line=504, content='cursor.execute(query_principal)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\categorias_manager.py', line=520, content='cursor.execute(query_tendencias)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\productos_manager.py', line=62, content='cursor.execute(\"SELECT SCOPE_IDENTITY()\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\productos_manager.py', line=156, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\reportes_manager.py', line=294, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\reportes_manager.py', line=374, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\reportes_manager.py', line=426, content='cursor.execute(\"SELECT COUNT(*) FROM inventario WHERE activo = 1\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\reportes_manager.py', line=745, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\inventario\\\\submodules\\\\reservas_manager.py', line=461, content='cursor.execute(\"SELECT SCOPE_IDENTITY()\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=189, content='cursor.execute(\"SELECT @@IDENTITY\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=250, content='cursor.execute(query_total)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=255, content='cursor.execute(query_disponibles)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=316, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=541, content='cursor.execute(sql_count_total)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=546, content='cursor.execute(sql_count_transito)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\logistica\\\\model.py', line=559, content='cursor.execute(sql_count_pendientes)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\model.py', line=349, content='cursor.execute(sql_count)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\model.py', line=659, content='cursor.execute(sql_stats)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\model.py', line=674, content='cursor.execute(sql)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=85, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=152, content='cursor.execute(query_total)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=160, content='cursor.execute(query_estados)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=169, content='cursor.execute(query_valor)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=177, content='cursor.execute(query_activas)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=185, content='cursor.execute(query_duracion)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\obras\\\\submodules\\\\consultas_manager.py', line=228, content='cursor.execute(query_count)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\pedidos\\\\view_complete.py', line=58, content='cursor.execute()', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\pedidos\\\\view_complete.py', line=65, content='cursor.execute(\"SELECT COUNT(*) FROM pedidos WHERE estado = \\'PENDIENTE\\'\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\pedidos\\\\view_complete.py', line=72, content='cursor.execute(\"SELECT COUNT(*) FROM pedidos WHERE estado = \\'CONFIRMADO\\'\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\pedidos\\\\view_complete.py', line=79, content='cursor.execute(\"SELECT COUNT(*) FROM pedidos WHERE estado = \\'PRODUCCION\\'\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\pedidos\\\\view_complete.py', line=86, content='cursor.execute(\"SELECT COUNT(*) FROM pedidos WHERE estado = \\'ENTREGADO\\'\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\pedidos\\\\view_complete.py', line=93, content='cursor.execute(\"SELECT SUM(total) FROM pedidos WHERE estado != \\'CANCELADO\\'\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\auth_manager.py', line=137, content='cursor.execute(query_create)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\consultas_manager.py', line=100, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\consultas_manager.py', line=246, content='cursor.execute(query_fallos)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\consultas_manager.py', line=264, content='cursor.execute(query_bloqueadas)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\consultas_manager.py', line=282, content='cursor.execute(query_inactivos)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\profiles_manager.py', line=77, content='cursor.execute(\"SELECT COUNT(*) FROM usuarios\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\profiles_manager.py', line=81, content='cursor.execute(\"SELECT COUNT(*) FROM usuarios WHERE activo = 1\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\profiles_manager.py', line=217, content='cursor.execute(\"SELECT COUNT(*) FROM usuarios WHERE username = ?\", (username,))', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\profiles_manager.py', line=223, content='cursor.execute(\"SELECT COUNT(*) FROM usuarios WHERE email = ?\", (email,))', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\usuarios\\\\submodules\\\\sessions_manager.py', line=31, content='cursor.execute(\"SELECT COUNT(*) FROM sesiones_usuario WHERE is_active = 1\")', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=88, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=156, content='cursor.execute(query_total)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=164, content='cursor.execute(query_valor)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=170, content='cursor.execute(query_tipos)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=179, content='cursor.execute(query_stock_bajo)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=187, content='cursor.execute(query_proveedores)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=230, content='cursor.execute(query_count)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=275, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\modules\\\\vidrios\\\\submodules\\\\consultas_manager.py', line=366, content='cursor.execute(query)', severity='P0', status='pending')",
        "SecurityIssue(type='unsafe_cursor_execute', file='rexus\\\\utils\\\\query_performance_analyzer.py', line=420, content='cursor.execute(\"SELECT * FROM productos\")', severity='P0', status='pending')"
      ],
      "status": "FAILED"
    },
    {
      "type": "except_exception_validation",
      "issues_found": 0,
      "issues": [],
      "status": "PASSED"
    },
    {
      "type": "print_statements_validation",
      "issues_found": 0,
      "issues": [],
      "status": "PASSED"
    },
    {
      "type": "sql_injection_validation",
      "issues_found": 0,
      "issues": [],
      "status": "PASSED"
    }
  ],
  "recommendations": [
    "Implementar consultas parametrizadas en todos los cursor.execute"
  ]
}